<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width">
    <title>大量小差解释</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: {
          equationNumbers: { autoNumber: "AMS" },
          extensions: ["color.js"]
        }
      })
    </script>
    <style>
      body {
        background: #F5F5DC;
      }

      .document {
        max-width: 800px;
        margin-left: auto;
        margin-right: auto;
      }

      .title {
        margin-left: auto;
        margin-right: auto;
        font-size: 36px;
        font-weight: bold;
        text-align: center;
      }
    </style>
  </head>
  <body>
    <div class="document">
      \(
        \require{cancel}
        \newcommand{\d}[2]{\frac{d #1}{d #2}}
        \newcommand{\dt}[1]{\d{#1}{t}}
        \newcommand{\pd}[2]{\frac{\partial #1}{\partial #2}}
        \newcommand{\pdt}[1]{\pd{#1}{t}}
        \newcommand{\hdiv}{\nabla_{\pi} \cdot \mathbf{v}}
        \newcommand{\cpocv}{\frac{C_p}{C_V}}
        \newcommand{\cvocp}{\frac{C_V}{C_p}}
      \)
      <div class="section">
        <p>
          地形追随坐标变换会导致气压梯度力变为两项，特别是在\(\sigma\)坐标系下，这两项大小相近，符号相反，相加结果有效位减少。下面以静力模式下的\(\sigma\)坐标为例解释这一问题。水平动量方程中的气压梯度力为\(\nabla_p \phi\)，当采用如下\(\sigma\)坐标时
          \[
            \sigma = \frac{p - p_t}{p_s - p_t}
          \]
          气压梯度力变为两项
          \[
            \begin{align*}
              \nabla_p \phi & = \nabla_\sigma \phi - \pd{\sigma}{p} \nabla_\sigma p \pd{\phi}{\sigma} \\
                & = \nabla_\sigma \phi - \cancel{\pd{\sigma}{p}} \nabla_\sigma p \pd{\phi}{p} \cancel{\pd{p}{\sigma}} \quad \leftarrow \text{代入静力平衡方程} \\
                & = \nabla_\sigma \phi + \frac{1}{\rho} \nabla_\sigma p
            \end{align*}
          \]
          再根据静力平衡方程可知，上面两项大小相近，符号相反。
        </p>
        <p>
          静力气压坐标转换也会导致气压梯度力变为两项
          \[
            \pd{p}{\pi} \nabla_\pi \phi + \frac{1}{\rho} \nabla_\pi p
          \]
        </p>
      </div>
    </div>
  </body>
</html>